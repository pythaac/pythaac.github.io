---
layout: post
title: 인터넷이란
date: 2025-02-21 21:38 +0900
toc: true
comments: true
categories:
- 리포트
- CS기초
tags:
- 인터넷
- 네트워크
description: 인터넷 개요 및 네트워크 개요
---

서버와 클라이언트의 통신을 중심으로 인터넷의 역할과 통신 방법에 대해 정리해보려 합니다. 통신을 위해 필요한 것과 네트워크의 구성요소들이 어떤 방식으로 이들의 통신을 전달하는지 하나씩 정리해보겠습니다.

## OSI 7계층
기본적으로 네트워크는 OSI 7계층에 따라 통신합니다. 서버와 클라이언트는 모두 각 계층에서 필요한 작업을 하며, 계층에 맞는 순서로 처리합니다. OSI 7계층은 다음과 같습니다.

| 계층 | 이름 | 역할 | 관련 actor |
|---|---|---|---|
| 7 | **응용(Application) 계층** | 사용자와 네트워크 간 상호작용 (예: HTTP, FTP, DNS) | 웹 브라우저, 서버 |
| 6 | **표현(Presentation) 계층** | 데이터 형식 변환, 암호화, 압축 (예: SSL/TLS) | 웹 서버, SSL 암호화 장치 |
| 5 | **세션(Session) 계층** | 세션 연결 및 유지 (예: TCP 세션 관리) | 운영체제, 서버 프로세스 |
| 4 | **전송(Transport) 계층** | 데이터의 신뢰성 있는 전송 (TCP, UDP) | TCP/UDP 프로토콜 |
| 3 | **네트워크(Network) 계층** | IP 주소를 기반으로 라우팅 수행 | 라우터, 게이트웨이 |
| 2 | **데이터 링크(Data Link) 계층** | MAC 주소를 기반으로 프레임 전달 | 스위치 |
| 1 | **물리(Physical) 계층** | 전기 신호, 광 신호 등 물리적 데이터 전송 | 네트워크 케이블, 무선(Wi-Fi) |


---

## 데이터 링크 계층에서 스위칭(물리/데이터 링크 계층)
> LAN의 정의는 ARP Request가 미치는 영역이다

### 키워드
**MAC주소, 스위치, ARP, LAN**

### MAC 주소
- MAC주소는 NIC의 고유 물리주소를 의미합니다.
- LAN에서는 MAC 주소를 통해 목적지와 통신합니다.
- MAC 주소를 사용하는 이유는 논리적 주소인 IP가 유동적으로 변하기 때문이며, MAC 주소만 사용하기엔 라우팅 테이블을 만들기 어렵습니다.

### ARP와 스위치
- ARP(Address Resolution Protocol)은 IP와 MAC 주소를 1:1 매칭하여 목적지를 찾는 방식입니다.
- 같은 LAN에 있는 서버와 클라이언트는 ARP Request를 통해 MAC주소를 묻고, ARP Response로 MAc주소를 받습니다.
- 스위치(Switch)는 LAN의 중심에 있는 네트워크 기기이며, MAC 주소 테이블을 통해 MAC주소와 인터페이스 번호를 저장하고 프레임을 전송합니다.

### ARP 동작 과정
- 모든 단말은 자신만의 라우팅 테이블이 있어, 보내려는 패킷의 목적지 IP가 자신이 소속된 IP 대역인지 알 수 있습니다.
- `192.168.1.1`이 `192.168.1.3`에게 데이터를 전달하려 합니다. 라우팅 테이블로 같은 LAN임을 확인하고, MAC 주소를 알기위해 ARP Request를 뿌립니다.
- Broadcast로 보내진 ARP Request는 모든 LAN에 연결된 단말에 전달되며, `192.168.1.3`은 이를 받고 ARP Response로 자신의 MAC주소를 보냅니다.
- `192.168.1.1`은 ARP Response를 통해 ARP Table에 `192.168.1.3`의 IP와 MAC주소를 적고, 이를 통해 `192.168.1.3`의 MAC주소로 패킷을 전달합니다.

---

## IP 주소
LAN에서는 MAC주소를 통해 패킷을 전달할 수 있습니다. 그러나 ARP 동작 전에 IP를 통해 LAN을 확인하는 것과 같이, 기본적으로 IP를 통해 도착지를 특정합니다. IP 주소는 네트워크에서 각 장치를 식별하는 32bit의 논리적 주소입니다.

### 키워드
**IP, 서브넷 마스크, CIDR, 클래스, 공인/사설 IP**

### 서브넷 마스크와 CIDR
- 서브넷 마스크로 IP 주소는 네트워크 부분과 호스트 부분으로 나뉩니다.
- 서브넷 마스크는 32bit 중 네트워크 부분을 1, 호스트 부분을 0으로 나타냅니다.
- `172.16.1.1`이라는 IP 주소에 `255.255.0.0`이라는 서브넷 마스크가 설정되면, `172.16`은 네트워크 부분, `1.1`은 호스트 부분입니다.
- **CIDR(Classless Inter-Domain Routing)표기법**이란, 서브넷 마스크 표기법 중 하나 입니다.
- `172.16.1.1/16`과 같이 CIDR 표기법으로 `172.16`은 네트워크 부분, `1.1`은 호스트 부분을 표기할 수 있습니다.

### 클래스
IP 주소는 용도에 따라 A~E 클래스까지 나눌 수 있습니다.

| 클래스 | 앞쪽 4비트 | 주소 범위 | 사용 규모 |
|---|---|---|---|
| **클래스 A** | 0XXX | 0.0.0.0 ~ 127.255.255.255 | 통신 사업자 등 |
| **클래스 B** | 10XX | 128.0.0.0 ~ 191.255.255.255 | 대기업 등 |
| **클래스 C** | 110X | 192.0.0.0 ~ 223.255.255.255 | 중소 기업이나 가정 등 |
| **클래스 D** | 1110 | 224.0.0.0 ~ 239.255.255.255 | 특수 용도 |
| **클래스 E** | 1111 | 240.0.0.0 ~ 255.255.255.255 | 특수 용도 |

### 공인/사설 IP
IP 주소는 사용 장소에 따라 공인 IP와 사설 IP로 나눌 수 있습니다.
- 공인 IP(Public IP)는 인터넷에서 고유한 IP 주소로, ICANN이라는 조직에 의해 관리/할당됩니다.
- 사설 IP(Private IP)는 조직이나 가정 등 LAN에서 자유롭게 할당할 수 있는 주소입니다.
- 사설 IP 주소는 클래스별로 정해진 범위에서 사용 가능합니다.

| 클래스 | 주소 범위 | 서브넷 마스크 |
|---|---|---|---|
| **클래스 A** | 10.0.0.0 ~ 10.255.255.255 | 255.0.0.0 |
| **클래스 B** | 172.16.0.0 ~ 172.31.255.255 | 255.240.0.0 |
| **클래스 C** | 192.168.0.0 ~ 192.168.255.255 | 255.255.0.0 |

## 네트워크 계층에서 라우팅

### 키워드
**라우터, 게이트웨이, ISP, IGP, EGP, NAT, 공인 IP**

### IP와 라우터/게이트웨이
- IP 주소를 기반으로 목적지까지 패킷을 전달하는 역할은 라우터가 수행합니다.
- 라우터는 라우팅 테이블을 기반으로 패킷을 보내야할 hop을 결정합니다.
- 목적지가 라우팅 테이블에 해당하는 경우가 없으면 설정된 default 게이트웨이로 보냅니다.
- 게이트웨이는 LAN에서 WAN으로 나가는 출입구 개념을 의미하며, 라우터는 이러한 역할을 하는 장비입니다.

### ISP와 라우팅
가정을 기준으로 ISP는 다음과 같은 구성으로 볼 수 있습니다.

#### 엣지 네트워크 (Access Network)
사용자의 트래픽을 받아주며, 보통 가정용 공유기와 연결됩니다.
```
[내 PC] → [내 라우터(게이트웨이)] → [ISP 엣지 라우터]
```

#### 백본 네트워크 (Core Network)
ISP의 중추 네트워크로 ISP 라우터 간의 연결입니다.
```
[ISP 엣지 라우터] → [ISP 코어 라우터] → [ISP 백본 라우터]
```

| 명칭 | 역할 |
|---|---|
| **코어 라우터 (Core Router)** | ISP 내부에서 트래픽을 최적의 경로로 전달 |
| **백본 라우터 (Backbone Router)** | ISP의 대형 데이터 센터 또는 타 ISP와 연결되는 주요 라우터 |

#### 피어링 및 업스트림 (Peering & Upstream)
ISP 백본 라우터를 통해 다른 ISP로 연결됩니다.
```
[ISP 백본 라우터] → [업스트림 ISP or 피어링 ISP] → [다른 ISP]
```

| 명칭 | 역할 |
|---|---|
| **업스트림 (Upstream ISP)** | 더 큰 네트워크(ISP)로 연결하는 경로 |
| **피어링 (Peering ISP)** | 동급 ISP 간 트래픽을 직접 주고받는 연결 |
| **트랜짓 (Transit)** | 작은 ISP가 대형 ISP를 통해 인터넷을 사용하는 방식 |

### IGP, EGP
EGP(Exterior Gateway Protocol)와 IGP(Interior Gateway Protocol)는 라우팅 프로토콜의 두 가지 주요 범주입니다.
- IGP는 같은 자율 시스템(AS, Autonomous System) 내에서 라우팅할 때 사용됩니다.
- 즉, 기업 내부 네트워크, ISP 내부 네트워크 등 한 개의 AS 내부에서 사용하는 프로토콜입니다.
- EGP는 서로 다른 AS 간의 라우팅을 담당하는 프로토콜입니다.
- 즉, ISP들 간의 네트워크 연결을 조정하는 역할을 합니다.
- BGP (Border Gateway Protocol): 현재 인터넷에서 유일하게 사용되는 EGP입니다.
- ISP 내부망까지는 IGP, ISP간에는 EGP로 라우팅됩니다.

### 공인 IP
이렇게 복잡한 환경에서 공인 IP는 어떻게 전 세계에서 고유할 수 있을까요? 네트워크의 IP는 



### **서브넷 마스크와 CIDR**
- **서브넷 마스크**: 네트워크 부분과 호스트 부분을 구분하는 역할 (예: `255.255.255.0`)
- **CIDR(Classless Inter-Domain Routing) 표기법**: IP 주소 뒤에 `/`와 비트 수를 붙여 표현 (예: `192.168.1.0/24`)

### **공인(Public) vs 사설(Private) IP**
- **공인 IP**: 인터넷에서 사용되는 고유한 주소 (ISP에서 할당)
- **사설 IP**: 내부 네트워크에서만 사용되는 주소 (NAT를 통해 공인 IP로 변환)
  - 예) `192.168.0.0/16`, `172.16.0.0/12`, `10.0.0.0/8`

---


### **스위치(Switch)**
- **역할:** 동일 네트워크(LAN) 내에서 **MAC 주소를 기반으로 프레임 전달**
- **관련 계층:** 데이터 링크 계층(2계층)
- **동작 방식:** 
  - 클라이언트가 패킷을 보낼 때 **목적지 MAC 주소를 확인**하고 적절한 포트로 전송
  - ARP(주소 결정 프로토콜)를 사용해 IP-MAC 매핑 수행

### **라우터(Router)**
- **역할:** 서로 다른 네트워크 간에 **IP 주소를 기반으로 패킷을 전달**
- **관련 계층:** 네트워크 계층(3계층)
- **동작 방식:** 
  - IP 주소를 기반으로 라우팅 테이블을 조회하여 최적의 경로 선택
  - 목적지 네트워크가 같은 LAN 내에 있으면 바로 전달, 다른 네트워크면 **다른 라우터로 전달**

### **게이트웨이(Gateway)**
- **역할:** 서로 다른 네트워크 프로토콜을 사용하는 네트워크 간의 중개 역할
- **관련 계층:** 네트워크 계층(3계층) 이상
- **동작 방식:** 
  - 예를 들어, **내부망(사설 IP)과 외부망(공인 IP) 간의 변환 수행**
  - NAT(Network Address Translation)을 통해 내부 IP를 공인 IP로 변환

### **ISP(Internet Service Provider)**
- **역할:** 인터넷을 제공하는 네트워크 사업자로서 **라우팅을 수행**하고 IP 주소를 할당
- **관련 계층:** 네트워크 계층(3계층)
- **동작 방식:** 
  - 사용자가 인터넷에 접속할 때 ISP의 DNS 서버를 통해 도메인을 IP로 변환
  - **BGP(Border Gateway Protocol)**를 통해 다른 ISP 네트워크로 트래픽 전달

---

## 4. IP 주소 및 MAC을 이용한 actor들의 라우팅 과정

1. 클라이언트가 서버로 데이터를 전송하면 먼저 **ARP**를 사용해 MAC 주소를 알아냄
2. 같은 네트워크에 있으면 **스위치를 통해 MAC 주소를 기반으로 전달**
3. 다른 네트워크에 있으면 **라우터로 전달**
4. 라우터는 목적지 IP 주소를 보고 **라우팅 테이블을 조회하여 다음 홉(Next Hop) 결정**
5. 목적지가 다른 ISP에 있다면 **BGP를 통해 ISP 네트워크로 전달**
6. 최종적으로 목적지 서버가 패킷을 수신

---

## 네트워크 라우팅 시나리오 예시

### 1. 같은 LAN에 있는 서버/클라이언트의 라우팅 과정

#### 시나리오 개요
- 클라이언트(`192.168.1.10`)가 같은 네트워크(LAN)에 있는 서버(`192.168.1.20`)로 데이터를 전송하는 과정
- **스위치(Switch)**를 통해 MAC 주소 기반으로 프레임 전달

#### 과정 설명
1. 클라이언트(`192.168.1.10`)가 서버(`192.168.1.20`)로 데이터를 전송하려고 함.
2. 클라이언트는 목적지 IP(`192.168.1.20`)에 대한 **MAC 주소를 알지 못하면** ARP(Address Resolution Protocol) 요청을 브로드캐스트(`FF:FF:FF:FF:FF:FF`)로 전송.
3. 서버(`192.168.1.20`)가 자신의 MAC 주소를 포함한 ARP 응답을 클라이언트에게 전송.
4. 클라이언트는 받은 MAC 주소를 이용하여 **이더넷 프레임**을 생성하고 데이터를 전송.
5. **스위치(Switch)**는 클라이언트가 보낸 프레임을 받고, 목적지 MAC 주소를 기반으로 올바른 포트로 전달.
6. 서버(`192.168.1.20`)가 패킷을 수신하고 응답을 보냄.

#### 정리
- **데이터 링크 계층(2계층)**에서 MAC 주소를 기반으로 통신.
- 라우터를 거치지 않고, 스위치가 프레임을 전달.

---

### 2. 다른 LAN에 있는 서버/클라이언트의 라우팅 과정

#### 시나리오 개요
- 클라이언트(`192.168.1.10/24`)가 다른 네트워크(LAN)에 있는 서버(`192.168.2.20/24`)로 데이터를 전송하는 과정
- **라우터(Router)**가 패킷을 라우팅하여 전달

#### 과정 설명
1. 클라이언트가 목적지 IP(`192.168.2.20`)를 확인한 후 **서브넷 마스크(`255.255.255.0`)를 적용**하여 같은 네트워크인지 판단.
2. `192.168.1.10/24`와 `192.168.2.20/24`는 다른 네트워크이므로, **패킷을 기본 게이트웨이(`192.168.1.1`)로 전송**해야 함.
3. 클라이언트는 ARP를 사용하여 **라우터의 MAC 주소**를 알아냄.
4. 클라이언트는 **목적지 MAC 주소를 라우터의 MAC 주소로 설정**하여 이더넷 프레임을 생성하고 전송.
5. 라우터는 **네트워크 계층(3계층)**에서 패킷의 목적지 IP(`192.168.2.20`)를 확인하고 라우팅 테이블을 조회.
6. 라우팅 테이블에 `192.168.2.0/24` 네트워크가 존재하므로, 해당 네트워크로 패킷을 전달.
7. 라우터는 ARP를 사용하여 서버(`192.168.2.20`)의 MAC 주소를 알아내고, 새로운 이더넷 프레임을 생성하여 서버로 전송.
8. 서버(`192.168.2.20`)가 패킷을 수신하고 응답을 보냄.

#### 정리
- **네트워크 계층(3계층)**에서 라우터가 목적지 IP를 기반으로 패킷을 전달.
- 데이터 링크 계층에서는 여전히 MAC 주소를 사용하여 전달.

---

### 3. 다른 ISP에 있는 서버/클라이언트의 라우팅 과정

#### 시나리오 개요
- 클라이언트(`192.168.1.10`)가 `Google.com` 서버(`142.250.190.78`)로 데이터를 전송하는 과정
- **ISP 라우터 및 BGP(Border Gateway Protocol)를 통한 글로벌 라우팅 수행**

#### 과정 설명

**(1) DNS를 통한 IP 주소 조회**
1. 클라이언트가 `Google.com`에 접속하려고 함.
2. **DNS 요청**을 통해 `Google.com`의 IP(`142.250.190.78`)를 조회.

**(2) 패킷 전달 과정**
3. 클라이언트는 IP 주소(`142.250.190.78`)를 확인한 후, 서브넷 마스크를 적용하여 **다른 네트워크임을 인식**.
4. 기본 게이트웨이(`192.168.1.1`)로 패킷을 전송하기 위해 **ARP를 사용하여 라우터의 MAC 주소**를 조회.
5. 클라이언트는 **이더넷 프레임의 목적지 MAC 주소를 라우터의 MAC 주소로 설정**하고 패킷을 전송.
6. 라우터는 패킷의 목적지 IP(`142.250.190.78`)를 확인하고, **라우팅 테이블을 조회하여 ISP 게이트웨이로 전송**.
7. ISP 게이트웨이는 **BGP(Border Gateway Protocol)**를 사용하여 글로벌 라우팅 테이블을 조회.
8. 최적의 경로를 찾고, **상위 ISP 또는 백본 네트워크로 패킷을 전달**.
9. 여러 개의 ISP 네트워크를 거쳐 최종적으로 Google의 데이터센터에 도착.
10. Google 서버(`142.250.190.78`)가 요청을 처리한 후 응답을 반환.

#### 정리
- **라우터와 ISP 라우팅을 거쳐 글로벌 인터넷으로 패킷이 전달됨**.
- **BGP 프로토콜을 활용하여 최적의 경로를 찾아 패킷을 전달**.
- **IP 주소를 기반으로 네트워크 계층에서 라우팅이 이루어지며, 데이터 링크 계층에서는 여전히 MAC 주소를 사용**.

---

### 4. 전체 흐름 요약

1. **같은 네트워크(LAN) 내 통신**: 스위치가 MAC 주소를 기반으로 프레임 전달.
2. **다른 LAN 간 통신**: 라우터가 목적지 IP를 확인하고 적절한 네트워크로 패킷을 전달.
3. **인터넷을 통한 글로벌 통신**: ISP 게이트웨이 및 BGP를 활용하여 목적지 네트워크까지 패킷을 전송.


## Reference
- https://aws-hyoh.tistory.com/70